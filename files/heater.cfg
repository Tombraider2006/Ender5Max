[mcu expander]
serial: /dev/serial/by-id/usb-Klipper_stm32f042x6_120031001653304B4D323431-if00
restart_method: command
#========================================================
#=================== iHeaterS cfg (Beta 1) ==============
#========================================================

# –ò–∑–º–µ–Ω–µ–Ω–∏—è 2025-05-21_23-15-34:
# - –î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å–µ–∫—Ü–∏–π —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è.
# - –ö–æ–¥ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω –¥–ª—è —É–¥–æ–±–æ—á–∏—Ç–∞–µ–º–æ—Å—Ç–∏: –¥–æ–±–∞–≤–ª–µ–Ω—ã –æ—Ç—Å—Ç—É–ø—ã, –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏, –≤—ã—Ä–æ–≤–Ω–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.
# - –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º –∫ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ –∫–æ–¥–∞, –≤–∫–ª—é—á–∞—è G-–∫–æ–¥ –≤–Ω—É—Ç—Ä–∏ –º–∞–∫—Ä–æ—Å–æ–≤.
# - –ö–æ–¥ –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ Beta 1.

### –°–µ–∫—Ü–∏—è 1: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∏–Ω–æ–≤ iHeaterS
# –û–ø–∏—Å–∞–Ω–∏–µ: –≠—Ç–∞ —Å–µ–∫—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø–∏–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è, –¥–∞—Ç—á–∏–∫–æ–≤ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–æ–≤. –°–µ–∫—Ü–∏—è –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞, —Ç–∞–∫ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è [duplicate_pin_override] –∏–∑ –¥—Ä—É–≥–æ–≥–æ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, printer.cfg).
#===================== iHeaterS pins =====================
# –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∏–Ω–æ–≤ –¥–ª—è –≥–∏–±–∫–æ—Å—Ç–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
[duplicate_pin_override]              # –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∏–Ω–æ–≤ (–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ)
pins:                                 # –°–ø–∏—Å–æ–∫ –ø–∏–Ω–æ–≤ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ)
    expander:PA5,                             # –ü–∏–Ω PC0: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª–µ–º Heater_TT
    expander:PA6,
    expander:PA3                     # –ü–∏–Ω PC5: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–∞—Ç—á–∏–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (—Å–æ–≤–º–µ—Å—Ç–Ω–æ —Å chamber_temp)
#    PB1,                             # –ü–∏–Ω PB1: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–æ–º chamber_heater_fan
#    PC8                              # –ü–∏–Ω PC8: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–¥—É–≤–Ω—ã–º –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–æ–º blower_fan
# –ü–∏–Ω—ã –¥–ª—è –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è, –¥–∞—Ç—á–∏–∫–æ–≤ –∏ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–æ–≤ (PC5 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–≤—É—Ö –¥–∞—Ç—á–∏–∫–æ–≤)

### –°–µ–∫—Ü–∏—è 2: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è iHeaterS
# –û–ø–∏—Å–∞–Ω–∏–µ: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª–µ–º –∫–∞–º–µ—Ä—ã (Heater_TT), –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞–º–∏ (chamber_heater_fan, blower_fan) –∏ –¥–∞—Ç—á–∏–∫–æ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (Heater_TS). –í–∫–ª—é—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã PID-—Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–≥—Ä–µ–≤–∞.
#==================== iHeaterS CONFIG ====================
# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ –∫–∞–ª–∏–±—Ä–æ–≤–∫–µ PID –¥–ª—è –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è –∫–∞–º–µ—Ä—ã:
#üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
#     PID_CALIBRATE HEATER=Heater_TT TARGET=45         # –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ PID –Ω–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ 45¬∞C
#     PID parameters for 45¬∞C:                         # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã PID –¥–ª—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã 45¬∞C:
#                            pid_Kp=65.373             # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ (Kp) –¥–ª—è PID
#                            pid_Ki=0.214              # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω–æ—Å—Ç–∏ (Ki) –¥–ª—è PID
#                            pid_Kd=4993.676           # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ (Kd) –¥–ª—è PID
#üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
# –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –Ω–∞–≥—Ä–µ–≤–∞ –∫–∞–º–µ—Ä—ã.
# –ë–µ–∑ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ PID —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –º–æ–∂–µ—Ç –ø—Ä–µ–≤—ã—à–∞—Ç—å –∑–∞–¥–∞–Ω–Ω—É—é –∏–ª–∏ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ!

[heater_generic Heater_TT]                # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è Heater_TT –¥–ª—è –∫–∞–º–µ—Ä—ã
heater_pin: expander:PA0                  # –ü–∏–Ω –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª–µ–º 
max_power: 0.7                            # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è (90% –æ—Ç –≤–æ–∑–º–æ–∂–Ω–æ–π)
sensor_type: EPCOS 100K B57560G104F       # –¢–∏–ø –¥–∞—Ç—á–∏–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (—Ç–µ—Ä–º–∏—Å—Ç–æ—Ä EPCOS 100K)
sensor_pin: expander:PA6                  # –ü–∏–Ω –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–∞—Ç—á–∏–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (PC5)
pwm_cycle_time: 0.3                       # –í—Ä–µ–º—è —Ü–∏–∫–ª–∞ –®–ò–ú –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª–µ–º (0.3 —Å–µ–∫—É–Ω–¥—ã)
min_temp: 0                               # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–æ–ø—É—Å—Ç–∏–º–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (¬∞C)
max_temp: 120                             # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–ø—É—Å—Ç–∏–º–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (¬∞C)
control: pid                              # –ú–µ—Ç–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª–µ–º (PID-—Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ)
pid_Kp: 65.373                            # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ PID (Kp)
pid_Ki: 0.214                             # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω–æ—Å—Ç–∏ PID (Ki)
pid_Kd: 4993.676                          # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ PID (Kd)

[verify_heater Heater_TT]                 # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è Heater_TT
max_error: 240                            # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–æ–ø—É—Å—Ç–∏–º–∞—è –æ—à–∏–±–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (–≥—Ä–∞–¥—É—Å–æ–≤)
check_gain_time: 1800                     # –í—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–±–æ—Ä–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (—Å–µ–∫—É–Ω–¥)
heating_gain: 1                           # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (¬∞C)


#[chamber_fan chamber_fan]
#pin: expander:PA0 
#max_power: 0.7
#shutdown_speed: 0
#kick_start_time: 0.5
#heater: Heater_TT
#fan_speed: 1.0
#off_below: 0
#idle_timeout:30
#idle_speed:0.5

[heater_fan chamber_heater_fan]           # –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª–µ–º –∫–∞–º–µ—Ä—ã (chamber_heater_fan)
pin: expander:PA1                         # –ü–∏–Ω –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–æ–º (PB1)
heater: Heater_TT                         # –ù–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å, —Å –∫–æ—Ç–æ—Ä—ã–º —Å–≤—è–∑–∞–Ω –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä (Heater_TT)
heater_temp: 35.0                         # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä –≤–∫–ª—é—á–∞–µ—Ç—Å—è (¬∞C)
fan_speed: 1.0                            # –°–∫–æ—Ä–æ—Å—Ç—å –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ (1.0 = 100%)
shutdown_speed: 0                         # –°–∫–æ—Ä–æ—Å—Ç—å –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ –ø—Ä–∏ –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–∞ (0 = –≤—ã–∫–ª—é—á–µ–Ω)
kick_start_time: 0.5                      # –í—Ä–µ–º—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –∏–º–ø—É–ª—å—Å–∞ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ (—Å–µ–∫—É–Ω–¥)

[temperature_sensor Heater_TS]            # –î–∞—Ç—á–∏–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∫–∞–º–µ—Ä—ã (Heater_TS)
sensor_pin: expander:PA6                  # –ü–∏–Ω –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–∞—Ç—á–∏–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (PC5)
sensor_type: Generic 3950                 # –¢–∏–ø –¥–∞—Ç—á–∏–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (—Ç–µ—Ä–º–∏—Å—Ç–æ—Ä EPCOS 100K)
min_temp: 0                               # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–æ–ø—É—Å—Ç–∏–º–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (¬∞C)
max_temp: 140                             # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–ø—É—Å—Ç–∏–º–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (¬∞C)
[temperature_sensor Heater_TW]            # –î–∞—Ç—á–∏–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∫–∞–º–µ—Ä—ã (Heater_TS)
sensor_pin: expander:PA5                  # –ü–∏–Ω –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–∞—Ç—á–∏–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (PC5)
sensor_type: Generic 3950                 # –¢–∏–ø –¥–∞—Ç—á–∏–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (—Ç–µ—Ä–º–∏—Å—Ç–æ—Ä EPCOS 100K)
min_temp: 0                               # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–æ–ø—É—Å—Ç–∏–º–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (¬∞C)
max_temp: 140  
[temperature_fan blower_fan]              # –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä –¥–ª—è –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã (blower_fan), —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π
pin: expander:PA3                         # –ü–∏–Ω –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–æ–º (PC8)
cycle_time: 0.0100                        # –í—Ä–µ–º—è —Ü–∏–∫–ª–∞ –®–ò–ú –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–æ–º (0.01 —Å–µ–∫—É–Ω–¥—ã)
hardware_pwm: false                       # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ –®–ò–ú (–æ—Ç–∫–ª—é—á–µ–Ω–æ)
max_power: 0.6                             # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ (1.0 = 100%)
shutdown_speed: 0                         # –°–∫–æ—Ä–æ—Å—Ç—å –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ –ø—Ä–∏ –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–∞ (0 = –≤—ã–∫–ª—é—á–µ–Ω)
sensor_type: EPCOS 100K B57560G104F       # –¢–∏–ø –¥–∞—Ç—á–∏–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (—Ç–µ—Ä–º–∏—Å—Ç–æ—Ä EPCOS 100K)
sensor_pin: expander:PA6                  # –ü–∏–Ω –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–∞—Ç—á–∏–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (PC5)
min_temp: 0                               # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–æ–ø—É—Å—Ç–∏–º–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (¬∞C)
max_temp: 70                              # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–ø—É—Å—Ç–∏–º–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (¬∞C)
control: watermark                        # –ú–µ—Ç–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–æ–º (watermark ‚Äî –ø–æ –ø–æ—Ä–æ–≥—É —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã)
max_delta: 0.5                            # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (¬∞C)
max_speed: 1.0                            # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ (1.0 = 100%)
min_speed: 0.0 

[fan_generic back_fans]
pin: expander:PA3                         # –ü–∏–Ω –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–æ–º (PC8)
cycle_time: 0.0100                        # –í—Ä–µ–º—è —Ü–∏–∫–ª–∞ –®–ò–ú –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–æ–º (0.01 —Å–µ–∫—É–Ω–¥—ã)
hardware_pwm: false                       # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ –®–ò–ú (–æ—Ç–∫–ª—é—á–µ–Ω–æ)
max_power: 1                              # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ (1.0 = 100%)
shutdown_speed: 0                         # –°–∫–æ—Ä–æ—Å—Ç—å –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ –ø—Ä–∏ –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–∞ (0 = –≤—ã–∫–ª—é—á–µ–Ω)

### –°–µ–∫—Ü–∏—è 3: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–º–µ—Ä–æ–π
# –û–ø–∏—Å–∞–Ω–∏–µ: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π –∫–∞–º–µ—Ä—ã –∏ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–æ–º. –≠—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –º–∞–∫—Ä–æ—Å–∞—Ö –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.
#==================== CHAMBER_VARS Setup =================
[gcode_macro CHAMBER_VARS]                # –ú–∞–∫—Ä–æ—Å –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–º–µ—Ä–æ–π
variable_chamber_target: 0                # –¶–µ–ª–µ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–∞–º–µ—Ä—ã (¬∞C)
variable_chamber_await_target: 0          # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –¥–æ—Å—Ç–∏—á—å –ø–µ—Ä–µ–¥ –ø–µ—á–∞—Ç—å—é (¬∞C)
variable_delta_temp: 1                    # –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π –∫–∞–º–µ—Ä—ã –∏ –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è (¬∞C)
variable_min_heater_temp: 40              # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è –¥–ª—è –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è (¬∞C)
variable_max_heater_temp: 65              # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è (¬∞C)
variable_control_interval: 30            # –ò–Ω—Ç–µ—Ä–≤–∞–ª –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (—Å–µ–∫—É–Ω–¥)
variable_air_min_delta: 0.5               # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (¬∞C)
variable_air_max_delta: 1.0               # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (¬∞C)
variable_blower_fan_min_temp: 33          # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–ª—è –≤—ã–∫–ª—é—á–µ–Ω–∏—è blower_fan (¬∞C)
variable_blower_fan_target_temp: 0        # –¶–µ–ª–µ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–ª—è blower_fan, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å chamber_target (¬∞C)
variable_last_state: "none"               # –ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
gcode:                                    # –ü—É—Å—Ç–æ–π G-–∫–æ–¥ (–º–∞–∫—Ä–æ—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö)

### –°–µ–∫—Ü–∏—è 4: –ú–∞–∫—Ä–æ—Å—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π
# –û–ø–∏—Å–∞–Ω–∏–µ: –ú–∞–∫—Ä–æ—Å—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π –∫–∞–º–µ—Ä—ã (M141, M191), –≤–∫–ª—é—á–µ–Ω–∏—è/–≤—ã–∫–ª—é—á–µ–Ω–∏—è –Ω–∞–≥—Ä–µ–≤–∞ (iHEATER_ON, iHEATER_OFF) –∏ –ª–æ–≥–∏–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (iHEATER_CONTROL, _iHEATER_CONTROL).
#==================== Temperature Macros =================
[gcode_macro M141]                        # –ú–∞–∫—Ä–æ—Å M141: —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∫–∞–º–µ—Ä—ã
gcode:                                    # –ù–∞—á–∞–ª–æ G-–∫–æ–¥–∞ –º–∞–∫—Ä–æ—Å–∞
    {% set chamber_target = params.S|default(printer["gcode_macro CHAMBER_VARS"].chamber_target)|int %}  # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ S (—Ü–µ–ª–µ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞) –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (int)
    {% set delta_temp = params.D|default(printer["gcode_macro CHAMBER_VARS"].delta_temp)|int %}          # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ D (–¥–µ–ª—å—Ç–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã) –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (int)
    {% set max_heater_temp = params.H|default(printer["gcode_macro CHAMBER_VARS"].max_heater_temp)|int %}# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ H (–º–∞–∫—Å. —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è) –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (int)
    {% set chamber_temp = printer["temperature_sensor Heater_TS"].temperature|float %}                   # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∫–∞–º–µ—Ä—ã (float)
    {% set blower_fan_min_temp = printer["gcode_macro CHAMBER_VARS"].blower_fan_min_temp|float %}       # –ü–æ–ª—É—á–µ–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è blower_fan (float)
    {% set control_interval = printer["gcode_macro CHAMBER_VARS"].control_interval|float %}              # –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (float)
    RESPOND prefix="M141" msg="–£—Å—Ç–∞–Ω–æ–≤–∫–∞: –∫–∞–º–µ—Ä–∞={chamber_target}¬∞C, –¥–µ–ª—å—Ç–∞={delta_temp}¬∞C, –º–∞–∫—Å. –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å={max_heater_temp}¬∞C, —Ç–µ–∫—É—â–∞—è={chamber_temp}¬∞C"  # –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
    SET_GCODE_VARIABLE MACRO=CHAMBER_VARS VARIABLE=chamber_target VALUE={chamber_target}                 # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π chamber_target
    SET_GCODE_VARIABLE MACRO=CHAMBER_VARS VARIABLE=delta_temp VALUE={delta_temp}                         # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π delta_temp
    SET_GCODE_VARIABLE MACRO=CHAMBER_VARS VARIABLE=max_heater_temp VALUE={max_heater_temp}               # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π max_heater_temp
    {% if chamber_target == 0 and chamber_temp > blower_fan_min_temp %}                                  # –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —Ü–µ–ª—å 0¬∞C –∏ —Ç–µ–∫—É—â–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤—ã—à–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π
        SET_GCODE_VARIABLE MACRO=CHAMBER_VARS VARIABLE=blower_fan_target_temp VALUE={blower_fan_min_temp}  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã blower_fan –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é
        SET_TEMPERATURE_FAN_TARGET TEMPERATURE_FAN=blower_fan TARGET={blower_fan_min_temp}                # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è blower_fan (–æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ –¥–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π)
    {% else %}                                                                                           # –ò–Ω–∞—á–µ (–µ—Å–ª–∏ —Ü–µ–ª—å –Ω–µ 0¬∞C –∏–ª–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∏–∂–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π)
        SET_GCODE_VARIABLE MACRO=CHAMBER_VARS VARIABLE=blower_fan_target_temp VALUE={chamber_target}     # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã blower_fan –Ω–∞ chamber_target
        SET_TEMPERATURE_FAN_TARGET TEMPERATURE_FAN=blower_fan TARGET={chamber_target}                     # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è blower_fan (–ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ chamber_target)
    {% endif %}                                                                                          # –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è –¥–ª—è blower_fan
    iHEATER_CONTROL                                                                                      # –í—ã–∑–æ–≤ –º–∞–∫—Ä–æ—Å–∞ iHEATER_CONTROL –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–≥—Ä–µ–≤–æ–º
    UPDATE_DELAYED_GCODE ID=_iHEATER_CONTROL DURATION={control_interval}                                 # –ó–∞–ø—É—Å–∫ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–∑–æ–≤–∞ _iHEATER_CONTROL —Å –∑–∞–¥–∞–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º

[gcode_macro M191]                        # –ú–∞–∫—Ä–æ—Å M191: —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã —Å –æ–∂–∏–¥–∞–Ω–∏–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
gcode:                                    # –ù–∞—á–∞–ª–æ G-–∫–æ–¥–∞ –º–∞–∫—Ä–æ—Å–∞
    {% set chamber_target = params.S|default(printer["gcode_macro CHAMBER_VARS"].chamber_target)|int %}  # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ S (—Ü–µ–ª–µ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞) –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (int)
    {% set delta_temp = params.D|default(printer["gcode_macro CHAMBER_VARS"].delta_temp)|int %}          # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ D (–¥–µ–ª—å—Ç–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã) –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (int)
    {% set max_heater_temp = params.H|default(printer["gcode_macro CHAMBER_VARS"].max_heater_temp)|int %}# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ H (–º–∞–∫—Å. —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è) –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (int)
    {% set chamber_await_target = params.W|default(chamber_target)|int %}                                # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ W (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ–∂–∏–¥–∞–Ω–∏—è) –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è chamber_target (int)
    {% set chamber_temp = printer["temperature_sensor Heater_TS"].temperature|float %}                   # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∫–∞–º–µ—Ä—ã (float)
    {% set blower_fan_min_temp = printer["gcode_macro CHAMBER_VARS"].blower_fan_min_temp|float %}       # –ü–æ–ª—É—á–µ–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è blower_fan (float)
    RESPOND prefix="M191" msg="–£—Å—Ç–∞–Ω–æ–≤–∫–∞: –∫–∞–º–µ—Ä–∞={chamber_target}¬∞C, –¥–µ–ª—å—Ç–∞={delta_temp}¬∞C, –º–∞–∫—Å. –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å={max_heater_temp}¬∞C, –æ–∂–∏–¥–∞–Ω–∏–µ={chamber_await_target}¬∞C, —Ç–µ–∫—É—â–∞—è={chamber_temp}¬∞C"  # –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
    M141 S{chamber_target} D{delta_temp} H{max_heater_temp}                                              # –í—ã–∑–æ–≤ –º–∞–∫—Ä–æ—Å–∞ M141 –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    SET_GCODE_VARIABLE MACRO=CHAMBER_VARS VARIABLE=chamber_await_target VALUE={chamber_await_target}     # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π chamber_await_target
    {% if chamber_target == 0 and chamber_temp > blower_fan_min_temp %}                                  # –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —Ü–µ–ª—å 0¬∞C –∏ —Ç–µ–∫—É—â–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤—ã—à–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π
        SET_GCODE_VARIABLE MACRO=CHAMBER_VARS VARIABLE=blower_fan_target_temp VALUE={blower_fan_min_temp}  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã blower_fan –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é
        SET_TEMPERATURE_FAN_TARGET TEMPERATURE_FAN=blower_fan TARGET={blower_fan_min_temp}                # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è blower_fan (–æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ –¥–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π)
        RESPOND prefix="M191" msg="–û—Ö–ª–∞–∂–¥–µ–Ω–∏–µ –¥–æ {blower_fan_min_temp}¬∞C –Ω–∞—á–∞—Ç–æ"                          # –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –Ω–∞—á–∞–ª–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è
    {% else %}                                                                                           # –ò–Ω–∞—á–µ (–µ—Å–ª–∏ —Ü–µ–ª—å –Ω–µ 0¬∞C –∏–ª–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∏–∂–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π)
        SET_GCODE_VARIABLE MACRO=CHAMBER_VARS VARIABLE=blower_fan_target_temp VALUE={chamber_target}     # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã blower_fan –Ω–∞ chamber_target
        SET_TEMPERATURE_FAN_TARGET TEMPERATURE_FAN=blower_fan TARGET={chamber_target}                     # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è blower_fan (–ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ chamber_target)
    {% endif %}                                                                                          # –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è –¥–ª—è blower_fan
    {% if chamber_target > 0 %}                                                                          # –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —Ü–µ–ª–µ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –±–æ–ª—å—à–µ 0¬∞C
        TEMPERATURE_WAIT SENSOR="temperature_sensor Heater_TS" MINIMUM={chamber_await_target}            # –û–∂–∏–¥–∞–Ω–∏–µ, –ø–æ–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–∞–º–µ—Ä—ã –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω–µ—Ç chamber_await_target
        RESPOND prefix="M191" msg="–ö–∞–º–µ—Ä–∞ –¥–æ—Å—Ç–∏–≥–ª–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã {chamber_await_target}¬∞C"                 # –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
    {% endif %}                                                                                          # –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è –æ–∂–∏–¥–∞–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã

[gcode_macro iHEATER_ON]                  # –ú–∞–∫—Ä–æ—Å iHEATER_ON: –≤–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞–≥—Ä–µ–≤–∞ —Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
description: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –∫–æ–º–∞–Ω–¥–∞–º M141 & M191 —Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤  # –û–ø–∏—Å–∞–Ω–∏–µ –º–∞–∫—Ä–æ—Å–∞
gcode:                                    # –ù–∞—á–∞–ª–æ G-–∫–æ–¥–∞ –º–∞–∫—Ä–æ—Å–∞
    {% set s = params.CHAMBER_TEMP|default(printer["gcode_macro CHAMBER_VARS"].chamber_target)|int %}   # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ CHAMBER_TEMP (—Ü–µ–ª–µ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞) –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (int)
    {% set d = params.DELTA|default(printer["gcode_macro CHAMBER_VARS"].delta_temp)|int %}               # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ DELTA (–¥–µ–ª—å—Ç–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã) –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (int)
    {% set h = params.HEATER_MAX|default(printer["gcode_macro CHAMBER_VARS"].max_heater_temp)|int %}    # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ HEATER_MAX (–º–∞–∫—Å. —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è) –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (int)
    {% set w = params.CHAMBER_AWAIT_TEMP|default(printer["gcode_macro CHAMBER_VARS"].chamber_await_target)|int %}  # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ CHAMBER_AWAIT_TEMP (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ–∂–∏–¥–∞–Ω–∏—è) –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (int)
    {% if w > 0 %}                                                                                       # –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ–∂–∏–¥–∞–Ω–∏—è –±–æ–ª—å—à–µ 0¬∞C
        M191 S{s} D{d} H{h} W{w}                                                                         # –í—ã–∑–æ–≤ –º–∞–∫—Ä–æ—Å–∞ M191 —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –æ–∂–∏–¥–∞–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
    {% else %}                                                                                           # –ò–Ω–∞—á–µ (–µ—Å–ª–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ–∂–∏–¥–∞–Ω–∏—è 0¬∞C)
        M141 S{s} D{d} H{h}                                                                              # –í—ã–∑–æ–≤ –º–∞–∫—Ä–æ—Å–∞ M141 –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è
    {% endif %}                                                                                          # –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ –º–∞–∫—Ä–æ—Å–∞

[gcode_macro iHEATER_OFF]                 # –ú–∞–∫—Ä–æ—Å iHEATER_OFF: –≤—ã–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞–≥—Ä–µ–≤–∞
gcode:                                    # –ù–∞—á–∞–ª–æ G-–∫–æ–¥–∞ –º–∞–∫—Ä–æ—Å–∞
    SET_GCODE_VARIABLE MACRO=CHAMBER_VARS VARIABLE=chamber_target VALUE=0                               # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∫–∞–º–µ—Ä—ã –≤ 0¬∞C
    SET_GCODE_VARIABLE MACRO=CHAMBER_VARS VARIABLE=chamber_await_target VALUE=0                         # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –æ–∂–∏–¥–∞–Ω–∏—è –≤ 0¬∞C
    SET_GCODE_VARIABLE MACRO=CHAMBER_VARS VARIABLE=blower_fan_target_temp VALUE={printer["gcode_macro CHAMBER_VARS"].blower_fan_min_temp}  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã blower_fan –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é
    SET_GCODE_VARIABLE MACRO=CHAMBER_VARS VARIABLE=last_state VALUE='"none"'                            # –°–±—Ä–æ—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –≤ "none"
    SET_HEATER_TEMPERATURE HEATER=Heater_TT TARGET=0                                                    # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è –≤ 0¬∞C (–≤—ã–∫–ª—é—á–µ–Ω–∏–µ)
    CLEAR_PAUSE                                                                                         # –°–±—Ä–æ—Å –ø–∞—É–∑—ã, –µ—Å–ª–∏ –æ–Ω–∞ –±—ã–ª–∞ –∞–∫—Ç–∏–≤–Ω–∞
    G4 P2000                                                                                            # –ü–∞—É–∑–∞ –Ω–∞ 2000 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ (2 —Å–µ–∫—É–Ω–¥—ã) –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
    {% set heater_target = printer["heater_generic Heater_TT"].target|float %}                          # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ü–µ–ª–µ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è (float)
    {% set heater_power = printer["heater_generic Heater_TT"].power|float %}                            # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –º–æ—â–Ω–æ—Å—Ç–∏ –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è (float)
    RESPOND prefix="iHeater_off" msg="–¶–µ–ª–µ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è={heater_target}¬∞C, –º–æ—â–Ω–æ—Å—Ç—å={heater_power}"  # –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è
    UPDATE_DELAYED_GCODE ID=_iHEATER_CONTROL DURATION=1                                                 # –ó–∞–ø—É—Å–∫ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–∑–æ–≤–∞ _iHEATER_CONTROL —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
    RESPOND prefix="iHeater_off" msg="–ù–∞–≥—Ä–µ–≤ –æ—Ç–∫–ª—é—á—ë–Ω"                                                  # –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ –Ω–∞–≥—Ä–µ–≤–∞

[gcode_macro iHEATER_CONTROL]             # –ú–∞–∫—Ä–æ—Å iHEATER_CONTROL: –ª–æ–≥–∏–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–≥—Ä–µ–≤–æ–º –∏ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ–º
gcode:                                    # –ù–∞—á–∞–ª–æ G-–∫–æ–¥–∞ –º–∞–∫—Ä–æ—Å–∞
    {% set target_chamber_temp = printer["gcode_macro CHAMBER_VARS"].chamber_target|float %}            # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∫–∞–º–µ—Ä—ã (float)
    {% set delta_temp = printer["gcode_macro CHAMBER_VARS"].delta_temp|float %}                         # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ–ª—å—Ç—ã —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (float)
    {% set min_heater_temp = printer["gcode_macro CHAMBER_VARS"].min_heater_temp|float %}               # –ü–æ–ª—É—á–µ–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è (float)
    {% set max_heater_temp = printer["gcode_macro CHAMBER_VARS"].max_heater_temp|float %}               # –ü–æ–ª—É—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è (float)
    {% set heater_temp = printer["heater_generic Heater_TT"].temperature|float %}                       # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è (float)
    {% set chamber_temp = printer["temperature_sensor Heater_TS"].temperature|float %}                  # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∫–∞–º–µ—Ä—ã (float)
    {% set control_interval = printer["gcode_macro CHAMBER_VARS"].control_interval|float %}             # –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (float)
    {% set air_min_delta = printer["gcode_macro CHAMBER_VARS"].air_min_delta|float %}                   # –ü–æ–ª—É—á–µ–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ä–∞–∑–Ω–∏—Ü—ã —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä (float)
    {% set air_max_delta = printer["gcode_macro CHAMBER_VARS"].air_max_delta|float %}                   # –ü–æ–ª—É—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ä–∞–∑–Ω–∏—Ü—ã —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä (float)
    {% set blower_fan_min_temp = printer["gcode_macro CHAMBER_VARS"].blower_fan_min_temp|float %}      # –ü–æ–ª—É—á–µ–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è blower_fan (float)
    {% set blower_fan_target_temp = printer["gcode_macro CHAMBER_VARS"].blower_fan_target_temp|float %}# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è blower_fan (float)
    {% set last_state = printer["gcode_macro CHAMBER_VARS"].last_state %}                               # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
    {% set current_state = "none" %}                                                                    # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –≤ "none"
    {% set target_heater_temp = 0.0 %}                                                                  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ü–µ–ª–µ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è (0¬∞C)
    {% if target_chamber_temp > 0 %}                                                                    # –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —Ü–µ–ª–µ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–∞–º–µ—Ä—ã –±–æ–ª—å—à–µ 0¬∞C
        {% if chamber_temp >= target_chamber_temp + 1.0 %}                                              # –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —Ç–µ–∫—É—â–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–∞–º–µ—Ä—ã –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–∞ —Ü–µ–ª–∏ + 1¬∞C
            {% set target_heater_temp = 0.0 %}                                                          # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è –≤ 0¬∞C (–≤—ã–∫–ª—é—á–µ–Ω–∏–µ)
            {% set current_state = "cooling" %}                                                         # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –≤ "cooling" (–æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ)
            {% if chamber_temp >= blower_fan_min_temp %}                                                # –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–∞–º–µ—Ä—ã –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–ª—è blower_fan
                SET_TEMPERATURE_FAN_TARGET TEMPERATURE_FAN=blower_fan TARGET={blower_fan_target_temp}   # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è blower_fan (–æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ)
                {% if last_state != "cooling" %}                                                        # –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ "cooling"
                    RESPOND prefix="iHeater_control" msg="–ö–∞–º–µ—Ä–∞ –≤—ã—à–µ —Ü–µ–ª–∏, –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ —Å blower_fan –ø—Ä–∏ {blower_fan_target_temp}¬∞C"  # –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –Ω–∞—á–∞–ª–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è
                {% endif %}                                                                             # –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è
            {% else %}                                                                                  # –ò–Ω–∞—á–µ (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∏–∂–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π)
                SET_TEMPERATURE_FAN_TARGET TEMPERATURE_FAN=blower_fan TARGET=0                          # –í—ã–∫–ª—é—á–µ–Ω–∏–µ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ blower_fan
                {% set current_state = "fan_off_below_min" %}                                           # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –≤ "fan_off_below_min"
                {% if last_state != "fan_off_below_min" %}                                              # –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ "fan_off_below_min"
                    RESPOND prefix="iHeater_control" msg="–ö–∞–º–µ—Ä–∞ –Ω–∏–∂–µ {blower_fan_min_temp}¬∞C, blower_fan –≤—ã–∫–ª—é—á–µ–Ω"  # –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞
                {% endif %}                                                                             # –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è
            {% endif %}                                                                                 # –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è –¥–ª—è blower_fan
        {% elif chamber_temp < target_chamber_temp - 1.0 %}                                             # –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–∞–º–µ—Ä—ã –º–µ–Ω—å—à–µ —Ü–µ–ª–∏ - 1¬∞C
            {% set temp_diff = target_chamber_temp - chamber_temp %}                                    # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É —Ü–µ–ª–µ–≤–æ–π –∏ —Ç–µ–∫—É—â–µ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π
            {% set value = temp_diff %}                                                                 # –ü—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω–∏—Ü—ã –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π value
            {% set inputLowerBound = air_min_delta %}                                                   # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∏–∂–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã —Ä–∞–∑–Ω–∏—Ü—ã —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä
            {% set inputUpperBound = air_max_delta %}                                                   # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã —Ä–∞–∑–Ω–∏—Ü—ã —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä
            {% set outputLowerBound = delta_temp %}                                                     # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∏–∂–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
            {% set outputUpperBound = [delta_temp, max_heater_temp - target_chamber_temp]|max %}        # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ (–º–∞–∫—Å–∏–º—É–º –∏–∑ delta_temp –∏ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è)
            {% set slope = (outputUpperBound - outputLowerBound) / (inputUpperBound - inputLowerBound) %}  # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –Ω–∞–∫–ª–æ–Ω–∞ –¥–ª—è –ª–∏–Ω–µ–π–Ω–æ–π –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏
            {% set clamped = ([inputLowerBound, value, inputUpperBound]|sort)[1] %}                     # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è value –º–µ–∂–¥—É –Ω–∏–∂–Ω–µ–π –∏ –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü–∞–º–∏
            {% set adjustment = outputLowerBound + slope * (clamped - inputLowerBound) %}               # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è
            {% set target_heater_temp = ([target_chamber_temp + adjustment, target_chamber_temp + delta_temp]|min)|round(2) %}  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è (–º–∏–Ω–∏–º—É–º –∏–∑ –¥–≤—É—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ 2 –∑–Ω–∞–∫–æ–≤)
            SET_TEMPERATURE_FAN_TARGET TEMPERATURE_FAN=blower_fan TARGET=0                              # –í—ã–∫–ª—é—á–µ–Ω–∏–µ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ blower_fan
            {% set current_state = "heating" %}                                                         # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –≤ "heating" (–Ω–∞–≥—Ä–µ–≤)
            {% if last_state != "heating" %}                                                            # –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ "heating"
                RESPOND prefix="iHeater_control" msg="–ù–∞–≥—Ä–µ–≤ –¥–æ —Ü–µ–ª–∏, blower_fan –≤—ã–∫–ª—é—á–µ–Ω"              # –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –Ω–∞—á–∞–ª–µ –Ω–∞–≥—Ä–µ–≤–∞
            {% endif %}                                                                                 # –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è
        {% else %}                                                                                      # –ò–Ω–∞—á–µ (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–∞–º–µ—Ä—ã –±–ª–∏–∑–∫–∞ –∫ —Ü–µ–ª–∏)
            {% set target_heater_temp = target_chamber_temp + delta_temp %}                             # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è (—Ü–µ–ª—å + –¥–µ–ª—å—Ç–∞)
            {% set current_state = "maintaining" %}                                                     # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –≤ "maintaining" (–ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ)
            {% if chamber_temp >= blower_fan_min_temp %}                                                # –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–∞–º–µ—Ä—ã –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–ª—è blower_fan
                SET_TEMPERATURE_FAN_TARGET TEMPERATURE_FAN=blower_fan TARGET={blower_fan_target_temp}   # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è blower_fan (–ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ)
                {% if last_state != "maintaining" %}                                                    # –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ "maintaining"
                    RESPOND prefix="iHeater_control" msg="–ö–∞–º–µ—Ä–∞ –±–ª–∏–∑–∫–æ –∫ —Ü–µ–ª–∏, –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —Å blower_fan –ø—Ä–∏ {blower_fan_target_temp}¬∞C"  # –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
                {% endif %}                                                                             # –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è
            {% else %}                                                                                  # –ò–Ω–∞—á–µ (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∏–∂–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π)
                SET_TEMPERATURE_FAN_TARGET TEMPERATURE_FAN=blower_fan TARGET=0                          # –í—ã–∫–ª—é—á–µ–Ω–∏–µ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ blower_fan
                {% set current_state = "fan_off_below_min" %}                                           # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –≤ "fan_off_below_min"
                {% if last_state != "fan_off_below_min" %}                                              # –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ "fan_off_below_min"
                    RESPOND prefix="iHeater_control" msg="–ö–∞–º–µ—Ä–∞ –Ω–∏–∂–µ {blower_fan_min_temp}¬∞C, blower_fan –≤—ã–∫–ª—é—á–µ–Ω"  # –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞
                {% endif %}                                                                             # –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è
            {% endif %}                                                                                 # –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è –¥–ª—è blower_fan
        {% endif %}                                                                                     # –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
    {% else %}                                                                                          # –ò–Ω–∞—á–µ (—Ü–µ–ª–µ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–∞–º–µ—Ä—ã 0¬∞C)
        {% if chamber_temp > blower_fan_min_temp %}                                                     # –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–∞–º–µ—Ä—ã –≤—ã—à–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–ª—è blower_fan
            SET_TEMPERATURE_FAN_TARGET TEMPERATURE_FAN=blower_fan TARGET={blower_fan_target_temp}       # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è blower_fan (–æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ)
            {% set current_state = "cooling_after_shutdown" %}                                          # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –≤ "cooling_after_shutdown"
            {% if last_state != "cooling_after_shutdown" %}                                             # –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ "cooling_after_shutdown"
                RESPOND prefix="iHeater_control" msg="–û—Ö–ª–∞–∂–¥–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã –ø–æ—Å–ª–µ –≤—ã–∫–ª—é—á–µ–Ω–∏—è"               # –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–∏ –ø–æ—Å–ª–µ –≤—ã–∫–ª—é—á–µ–Ω–∏—è
            {% endif %}                                                                                 # –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è
        {% else %}                                                                                      # –ò–Ω–∞—á–µ (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–∞–º–µ—Ä—ã –Ω–∏–∂–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π)
            SET_TEMPERATURE_FAN_TARGET TEMPERATURE_FAN=blower_fan TARGET=0                              # –í—ã–∫–ª—é—á–µ–Ω–∏–µ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ blower_fan
            {% set current_state = "cooled" %}                                                          # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –≤ "cooled" (–æ—Ö–ª–∞–∂–¥–µ–Ω–æ)
            {% if last_state != "cooled" %}                                                             # –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ "cooled"
                RESPOND prefix="iHeater_control" msg="–ö–∞–º–µ—Ä–∞ –æ—Ö–ª–∞–∂–¥–µ–Ω–∞ –¥–æ {blower_fan_min_temp}¬∞C"      # –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è
            {% endif %}                                                                                 # –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è
            {% set control_interval = 0.0 %}                                                            # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ 0 (–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–∑–æ–≤–∞)
        {% endif %}                                                                                     # –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è –¥–ª—è blower_fan
    {% endif %}                                                                                         # –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è –¥–ª—è —Ü–µ–ª–µ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
    SET_GCODE_VARIABLE MACRO=CHAMBER_VARS VARIABLE=last_state VALUE='"{current_state}"'                # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π last_state (—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
    SET_HEATER_TEMPERATURE HEATER=Heater_TT TARGET={target_heater_temp}                                # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è
    UPDATE_DELAYED_GCODE ID=_iHEATER_CONTROL DURATION={control_interval}                               # –ó–∞–ø—É—Å–∫ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–∑–æ–≤–∞ _iHEATER_CONTROL —Å –∑–∞–¥–∞–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º

[delayed_gcode _iHEATER_CONTROL]          # –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤ –º–∞–∫—Ä–æ—Å–∞ iHEATER_CONTROL
gcode:                                    # –ù–∞—á–∞–ª–æ G-–∫–æ–¥–∞
    iHEATER_CONTROL                       # –í—ã–∑–æ–≤ –º–∞–∫—Ä–æ—Å–∞ iHEATER_CONTROL –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–≥—Ä–µ–≤–æ–º